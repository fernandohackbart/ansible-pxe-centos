install
text
lang {{ hosts_lang }}
keyboard {{ hosts_keyboard }}
network --bootproto=dhcp --hostname {{ host_name }} --noipv6
timezone --utc {{ hosts_time_zone }} 
selinux --disabled
firewall --disabled
services --enabled=NetworkManager,sshd,docker
eula --agreed
ignoredisk --only-use=vda
reboot

bootloader --location=mbr
zerombr
clearpart --all --initlabel
part swap --asprimary --fstype="swap" --size=1024
part /boot --fstype xfs --size=200
part pv.01 --size=1 --grow
volgroup rootvg01 pv.01
logvol / --fstype xfs --name=lv01 --vgname=rootvg01 --size=1 --grow

rootpw {{ hosts_root_pw }}

url --url http://{{ kickstart_server_ip }}:{{ kickstart_server_port }}/install/{{ hosts_distribution }}/

%pre --log=/var/log/kickstart-pre.log
curl -o /etc/yum.repos.d/docker.repo http://{{ kickstart_server_ip }}:{{ kickstart_server_port }}/stage/docker.repo
%end

%packages --nobase --ignoremissing
@core
bind-utils
yum-utils
docker-engine-1.13.1 
docker-engine-selinux-1.13.1
%end

%post --log=/var/log/kickstart-post.log
mkdir -p /etc/systemd/system/docker.service.d
curl -o /etc/ntp.conf http://{{ kickstart_server_ip }}:{{ kickstart_server_port }}/stage/ntp.conf
curl -o /etc/resolv.conf http://{{ kickstart_server_ip }}:{{ kickstart_server_port }}/stage/resolv.conf
curl -o /etc/modules-load.d/overlay.conf http://{{ kickstart_server_ip }}:{{ kickstart_server_port }}/stage/overlay.conf
curl -o /etc/systemd/system/docker.service.d/override.conf http://{{ kickstart_server_ip }}:{{ kickstart_server_port }}/stage/docker-override.conf
systemctl start docker
systemctl enable docker
#open -s -w -- curl -o /etc/ntp.conf http://{{ kickstart_server_ip }}:{{ kickstart_server_port }}/stage/ntp.conf
#open -s -w -- curl -o /etc/resolv.conf http://{{ kickstart_server_ip }}:{{ kickstart_server_port }}/stage/resolv.conf
%end
